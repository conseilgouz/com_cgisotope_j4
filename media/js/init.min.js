var $close,grid_toggle,iso_article,iso,me,empty_message,items_limit,sav_limit,iso_height,iso_width,article_frame,resetToggle,options,myid,qsRegex,asc,sort_by,filters,rangeSlider,range_init,range_sel,min_range,max_range,cookie_name,std_parents=["cat","tags","lang","alpha"];function displayArticle(e){var t="";if(e.success){for(var r=0;r<e.length;r++){if(t+="<h1>"+e[r].title+'<button type="button" class="close">X</button></h1>',"k2"==options.entree&&e[r].image&&(t+='<span class="itemImage"><a class="moduleItemImage" href="'+e[r].link+'">',t+='<img src="'+e[r].image+'" alt="'+e[r].title+'" /></a></span>'),t+=e[r].fulltext,""==e[r].fulltext&&(t+=e[r].introtext),"k2"==options.entree&&e[r].extra_fields){if(t+='<div class="itemExtraFields"><ul>',Array.isArray(e[r].extra_fields)){$l=e[r].extra_fields.length;for(var o=0;o<$l;o++)t+='<li class="typeTextfield">',t+='<span class="itemExtraFieldsLabel">'+e[r].extra_fields[o].name+"</span>",t+='<span class="itemExtraFieldsValue">'+e[r].extra_fields[o].value+"</span>",t+="</li>"}else for(var o in $l=Object.values(e[r].extra_fields).length,e[r].extra_fields)t+='<li class="typeTextfield">',t+='<span class="itemExtraFieldsLabel">'+e[r].extra_fields[o].name+"</span>",t+='<span class="itemExtraFieldsValue">'+e[r].extra_fields[o].value+"</span>",t+="</li>";t+="</ul></div>"}if(e[r].scripts.length>0)for(var a=0;a<e[r].scripts.length;a++){var n=document.createElement("script");n.addEventListener("load",function(){console.log("Successfully loaded scripts")}),n.src=e[r].scripts[a],document.head.appendChild(n)}if(e[r].css.length>0)for(var a=0;a<e[r].css.length;a++){var u=document.createElement("link");u.type="text/css",u.rel="stylesheet",u.addEventListener("load",function(){console.log("Successfully loaded css")}),u.href=e[r].css[a],document.head.appendChild(u)}}iso_article.innerHTML=t,$close=document.querySelector("button.close"),["click","touchstart"].forEach(e=>{$close.addEventListener(e,resetToggle)})}else if(t=e.message,e.messages&&e.messages.error)for(var d=0;d<e.messages.error.length;d++)t+="<br/>"+e.messages.error[d]}function iso_cat_k2(e,t){if(me="#isotope-main-"+e+" ",items_limit=t.limit_items,sav_limit=t.limit_items,empty_message="true"==t.empty,filters={},asc="true"==t.ascending,-1!==(sort_by=t.sortby).indexOf("featured"))for(p=0,sortValue=sort_by.split(","),asc={};p<sortValue.length;p++)"featured"==sortValue[p]?asc[sortValue[p]]=!1:asc[sortValue[p]]="true"==t.ascending;0==t.limit_items&&(document.querySelector(me+".iso_button_more").style.display="none"),""==t.default_cat||null==t.default_cat||void 0===t.default_cat?filters.cat=["*"]:filters.cat=[t.default_cat],""==t.default_tag||null==t.default_tag||void 0===t.default_tag?filters.tags=["*"]:filters.tags=[t.default_tag],filters.lang=["*"],filters.alpha=["*"];var r=getCookie(cookie_name);""!=r&&($arr=r.split("&")).forEach(splitCookie),("masonry"==t.layout||"fitRows"==t.layout||"packery"==t.layout)&&(document.querySelector("#isotope-main-"+e+" .isotope_item").style.width=100/parseInt(t.nbcol)-2+"%"),"vertical"==t.layout&&(document.querySelector("#isotope-main-"+e+" .isotope_item").style.width="100%"),document.querySelector("#isotope-main-"+e+" .isotope_item").style.background=t.background,parseInt(t.imgmaxheight)>0&&(document.querySelector("#isotope-main-"+e+" .isotope_item img").style["max-height"]=t.imgmaxheight+"px"),parseInt(t.imgmaxwidth)>0&&(document.querySelector("#isotope-main-"+e+" .isotope_item img").style["max-width"]=t.imgmaxwidth+"px"),"true"==t.displayrange&&(min_range||(min_range=parseInt(t.minrange),max_range=parseInt(t.maxrange)),rangeSlider=new rSlider({target:"#rSlider",values:{min:parseInt(t.minrange),max:parseInt(t.maxrange)},step:parseInt(t.rangestep),set:[min_range,max_range],range:!0,tooltip:!0,scale:!0,labels:!0,onChange:rangeUpdated})),"string"==typeof sort_by&&(sort_by=sort_by.split(","));var o=document.querySelector(me+".isotope_grid");if(iso=new Isotope(o,{itemSelector:"none",percentPosition:!0,layoutMode:t.layout,getSortData:{title:"[data-title]",category:"[data-category]",date:"[data-date]",click:"[data-click] parseInt",rating:"[data-rating] parseInt",id:"[data-id] parseInt",featured:"[data-featured] parseInt"},sortBy:sort_by,sortAscending:asc,filter:function(e){if(e)return grid_filter(e)}}),imagesLoaded(o,function(){iso.options.itemSelector=".isotope_item";var e=Array.prototype.slice.call(iso.element.querySelectorAll(".isotope_item"));iso.appended(e),updateFilterCounts(),"random"==sort_by?iso.shuffle():iso.arrange(),"undefined"!=typeof $toogle&&(iso_width=grid_toggle.width(),iso_height=grid_toggle.height())}),(iso_div=document.querySelector(me+".isotope-div")).addEventListener("refresh",function(){iso.arrange()}),"infinite"==t.pagination){var a=Isotope.data(".isotope_grid"),n=new InfiniteScroll(".isotope_grid",{path:function e(){return"?start="+((currentpage=this.loadCount)+1)*t.page_count},append:".isotope_item",outlayer:a,status:".page-load-status"});let u=document.querySelector(me+".iso_button_more");if("true"==t.infinite_btn){n.option({button:".iso_button_more",loadOnScroll:!1});let d=document.querySelector(".iso_button_more");u.style.display="block",d.addEventListener("click",function(){n.loadNextPage(),n.option({loadOnScroll:!0}),d.style.display="none"})}else u.style.display="hide";n.on("append",function(e,t,r,o){infinite_buttons(r)})}(hamburgerbtn=document.getElementById("offcanvas-hamburger-btn"))&&hamburgerbtn.addEventListener("click",function(){var e=function(t,r=!1){!1===r||r>0?(!1!=r&&r--,setTimeout(function(){e(t,r)},100)):(void 0!==rangeSlider&&rangeSlider.onResize(),t())};e(function(){document.querySelector(".offcanvas")},3)});for(var g=document.querySelectorAll(me+".sort-by-button-group button"),p=0;p<g.length;p++)g[p].addEventListener("click",function(){update_sort_buttons(this);for(var e=0;e<g.length;e++)g[e].classList.remove("is-checked");this.classList.add("is-checked")});var m=document.querySelector(me+".quicksearch");m.addEventListener("keyup",debounce(function(){qsRegex=RegExp(m.value,"gi"),CG_Cookie_Set(e,"search",m.value),iso.arrange(),updateFilterCounts()})),document.querySelector(me+".ison-cancel-squared").addEventListener("click",function(){m.value="",qsRegex=RegExp(m.value,"gi"),CG_Cookie_Set(e,"search",m.value),rangeSlider&&(ranges=(range_sel=range_init).split(","),rangeSlider.setValues(parseInt(ranges[0]),parseInt(ranges[1])),CG_Cookie_Set(e,"range",range_sel)),filters.cat=["*"],filters.tags=["*"],filters.lang=["*"],filters.alpha=["*"],grouptype=["cat","tags","fields","alpha"];for(var t=0;t<grouptype.length;t++){agroup=document.querySelectorAll(me+".filter-button-group-"+grouptype[t]+" .btn");for(var r=0;r<agroup.length;r++)agroup[r].classList.remove("is-checked"),"*"==agroup[r].getAttribute("data-sort-value")&&addClass(agroup[r],"is-checked"),"all"==agroup[r].getAttribute("data-all")&&agroup[r].setAttribute("selected",!0),"fields"==grouptype[t]&&(removeClass(agroup[r],"iso_hide_elem"),filters[myparent=agroup[r].parentNode.getAttribute("data-filter-group")]="*")}agroup=document.querySelectorAll(me+".iso_lang .btn");for(var r=0;r<agroup.length;r++)agroup[r].classList.remove("is-checked"),"*"==agroup[r].getAttribute("data-sort-value")&&addClass(agroup[r],"is-checked"),"all"==agroup[r].getAttribute("data-all")&&agroup[r].setAttribute("selected",!0);agroup=document.querySelectorAll(me+'select[id^="isotope-select-"]');for(var r=0;r<agroup.length;r++){$val=agroup[r].parentElement.parentElement.parentElement.getAttribute("data-filter-group");var o=document.querySelector("joomla-field-fancy-select#isotope-select-"+$val).choicesInstance;o.removeActiveItems(),o.setChoiceByValue(""),filters[$val]=["*"]}$buttons=document.querySelectorAll("#clonedbuttons .is-checked");for(var r=0;r<$buttons.length;r++)$buttons[r].remove();update_cookie_filter(filters),iso.arrange(),updateFilterCounts(),document.querySelector(me+".quicksearch").focus()}),"listmulti"==t.displayfiltertags&&events_listmulti("tags"),"listmulti"==t.displayfiltercat&&events_listmulti("cat"),"listmulti"==t.displayfilterfields&&events_listmulti("fields"),("list"==t.displayfiltercat||"listex"==t.displayfiltercat)&&events_list("cat"),("list"==t.displayfiltertags||"listex"==t.displayfiltertags)&&events_list("tags"),("list"==t.displayfilterfields||"listex"==t.displayfilterfields)&&events_list("fields"),("multi"==t.displayfiltercat||"multiex"==t.displayfiltercat)&&events_multibutton("cat"),("multi"==t.displayfiltertags||"multiex"==t.displayfiltertags)&&events_multibutton("tags"),("multi"==t.displayfilterfields||"multiex"==t.displayfilterfields)&&events_multibutton("fields"),"multi"==t.language_filter&&events_multibutton("lang"),"multi"==t.displayalpha&&events_multibutton("alpha"),"button"==t.displayfiltercat&&events_button("cat"),"button"==t.displayfiltertags&&events_button("tags"),"button"==t.displayfilterfields&&events_button("fields"),"button"==t.language_filter&&events_button("lang"),"button"==t.displayalpha&&events_button("alpha"),(more=document.querySelector(me+".iso_button_more")).addEventListener("click",function(e){e.preventDefault(),items_limit>0?(items_limit=0,this.textContent=t.libless):(items_limit=t.limit_items,this.textContent=t.libmore),updateFilterCounts()});var h=document.getElementById("offcanvas_isotope");h&&(h.addEventListener("hidden.bs.offcanvas",function(){document.getElementById("offcanvas_isotope").classList.remove("offcanvas25"),document.getElementsByClassName("isotope_grid")[0].classList.remove("isogrid75"),document.getElementsByClassName("isotope_grid")[0].classList.remove("offstart"),document.getElementsByClassName("isotope_grid")[0].classList.remove("offend"),iso.arrange()}),h.addEventListener("show.bs.offcanvas",function(){document.getElementById("offcanvas_isotope").classList.add("offcanvas25"),document.getElementById("offcanvas_isotope").classList.contains("offcanvas-start")&&document.getElementsByClassName("isotope_grid")[0].classList.add("offstart"),document.getElementById("offcanvas_isotope").classList.contains("offcanvas-end")&&document.getElementsByClassName("isotope_grid")[0].classList.add("offend"),iso.arrange()}))}function rangeUpdated(){range_sel=rangeSlider.getValue(),range_init=rangeSlider.conf.values[0]+","+rangeSlider.conf.values[rangeSlider.conf.values.length-1],CG_Cookie_Set(myid,"range",range_sel),iso.arrange()}function events_listmulti(e){agroup=document.querySelectorAll(me+'select[id^="isotope-select-'+e+'"]');for(var t=0;t<agroup.length;t++)agroup[t].addEventListener("choice",function(e,t){filter_list_multi(this,e,"choice")}),agroup[t].addEventListener("removeItem",function(e,t){filter_list_multi(this,e,"remove")}),void 0===filters[$parent=agroup[t].parentElement.parentElement.parentElement.getAttribute("data-filter-group")]&&(filters[$parent]=["*"])}function events_list(e){agroup=document.querySelectorAll(me+".filter-button-group-"+e);for(var t=0;t<agroup.length;t++)agroup[t].addEventListener("choice",function(e,t){filter_list(this,e,"choice")}),agroup[t].addEventListener("removeItem",function(e,t){filter_list(this,e,"remove")})}function events_button(e){agroup="lang"==e?document.querySelectorAll(me+".iso_lang button"):document.querySelectorAll(me+".filter-button-group-"+e+" button");for(var t=0;t<agroup.length;t++)["click","touchstart"].forEach(e=>{agroup[t].addEventListener(e,function(e){filter_button(this,e),mygroup=this.parentNode.querySelectorAll("button");for(var t=0;t<mygroup.length;t++)removeClass(mygroup[t],"is-checked");addClass(this,"is-checked")})})}function events_multibutton(e){agroup="lang"==e?document.querySelectorAll(me+".iso_lang button"):document.querySelectorAll(me+".filter-button-group-"+e+" button");for(var t=0;t<agroup.length;t++)["click","touchstart"].forEach(e=>{agroup[t].addEventListener(e,function(e){filter_multi(this,e)})});for(var t=0;t<agroup.length;t++)agroup[t].addEventListener("click",function(){set_buttons_multi(this)})}function update_sort_buttons(e){var t=e.getAttribute("data-sort-value");if("random"==t){CG_Cookie_Set(myid,"sort",t+"-"),iso.shuffle();return}for(sens=e.getAttribute("data-sens"),t=t.split(","),hasClass(e,"is-checked")?"-"==sens?(e.setAttribute("data-sens","+"),asc=!0):(e.setAttribute("data-sens","-"),asc=!1):(sens=e.getAttribute("data-init"),e.setAttribute("data-sens",sens),asc=!0,"-"==sens&&(asc=!1)),sortAsc={},i=0;i<t.length;i++)"featured"==t[i]?sortAsc[t[i]]=!1:sortAsc[t[i]]=asc;CG_Cookie_Set(myid,"sort",t+"-"+asc),iso.options.sortBy=t,iso.options.sortAscending=sortAsc,iso.arrange()}function infinite_buttons(e){if("false"!=options.displayalpha){for(x=0;x<e.length-1;x++)if(alpha=e[x].attributes["data-alpha"].value,!(mybutton=document.querySelector(me+".filter-button-group-alpha .iso_button_alpha_"+alpha))){buttons=document.querySelector(me+".filter-button-group-alpha");var t=document.createElement("button");t.classList.add("btn"),t.classList.add(options.button_bootstrap.substr(4,100).trim()),t.classList.add("iso_button_alpha_"+alpha),t.setAttribute("data-sort-value",alpha),t.title=alpha,t.innerHTML=alpha,buttons.append(t)}}}function grid_filter(e){var t=!qsRegex||e.textContent.match(qsRegex),r=e.getAttribute("data-category"),o=e.getAttribute("class").split(" "),a=!1,n=!0;if(-1==filters.alpha.indexOf("*")&&(alpha=e.getAttribute("data-title").substring(0,1),-1==filters.alpha.indexOf(alpha))||-1==filters.lang.indexOf("*")&&(lalang=e.getAttribute("data-lang"),-1==filters.lang.indexOf(lalang)))return!1;if(rangeSlider){var u=e.getAttribute("data-range");range_sel!=range_init&&(ranges=range_sel.split(","),n=parseInt(u)>=parseInt(ranges[0])&&parseInt(u)<=parseInt(ranges[1]))}if("fields"!=options.article_cat_tag&&"catfields"!=options.article_cat_tag&&"tagsfields"!=options.article_cat_tag&&"cattagsfields"!=options.article_cat_tag){if(-1!=filters.cat.indexOf("*")&&-1!=filters.tags.indexOf("*"))return t&&n&&!0;if(count=0,-1==filters.cat.indexOf("*")){if(-1==filters.cat.indexOf(r))return!1;count=1}if(-1!=filters.tags.indexOf("*"))return t&&n&&!0;for(var d in o)-1!=filters.tags.indexOf(o[d])&&(a=!0,count+=1);return"true"==options.searchmultiex?(lgth=filters.cat.length+filters.tags.length,(-1!=filters.tags.indexOf("*")||-1!=filters.cat.indexOf("*"))&&(lgth-=1),t&&n&&count==lgth):t&&n&&a}if(ix=0,void 0===filters)return t&&n&&!0;for(x in filterslength=0,filters)"cat"!=x&&"lang"!=x&&"alpha"!=x&&"tags"!=x&&(filterslength++,-1!=filters[x].indexOf("*")&&ix++);if(catok=!1,-1==filters.cat.indexOf("*")){if(-1==filters.cat.indexOf(r))return!1;catok=!0}else catok=!0;if(tagok=!1,-1==filters.tags.indexOf("*"))for(var d in o)-1!=filters.tags.indexOf(o[d])&&(tagok=!0);else tagok=!0;if(ix==filterslength&&catok&&tagok)return t&&n&&!0;for(var g in count=0,o)for(x in filters)"cat"!=x&&"lang"!=x&&"alpha"!=x&&"tags"!=x&&-1!=filters[x].indexOf(o[g])&&(count+=1);if("true"!=options.searchmultiex)return t&&n&&count>=filterslength-ix&&catok&&tagok;for(x in lgth=0,filters)"cat"!=x&&"lang"!=x&&"alpha"!=x&&"tags"!=x&&(lgth+=filters[x].length,-1!=filters[x].indexOf("*")&&(lgth-=1));return t&&n&&count==lgth&&tagok}function filter_list(e,t,r){if($parent=e.getAttribute("data-filter-group"),$isclone=!1,"clonedbuttons"==e.parentNode.id?($selectid=$parent,$isclone=!0,sortValue=""):($selectid=e.getAttribute("data-filter-group"),sortValue=(sortValue=e.querySelector(".is-highlighted")).dataset.value),"undefined"==typeof sortValue&&(sortValue=""),choicesInstance=(elChoice=document.querySelector("joomla-field-fancy-select#isotope-select-"+$selectid)).choicesInstance,$needclone=!1,"offcanvas-body"==($grdparent=e.parentNode).className&&($needclone=!0),"remove"==r&&$needclone){removeFilter(filters,$parent,t.detail.value),(myclone=document.querySelector('#clonedbuttons button[data-sort-value="'+t.detail.value+'"]'))&&myclone.remove(),0==filters[$parent].length&&(filters[$parent]=["*"],choicesInstance.setChoiceByValue(""));return}if(""==sortValue){choicesInstance.removeActiveItems(),choicesInstance.setChoiceByValue(""),filters[$parent]=["*"],$buttons=document.querySelectorAll('#clonedbuttons [data-filter-group="'+$parent+'"]');for(var o=0;o<$buttons.length;o++)$buttons[o].remove()}else if(filters[$parent]=[sortValue],$needclone){$buttons=document.querySelectorAll('#clonedbuttons [data-filter-group="'+$parent+'"]');for(var o=0;o<$buttons.length;o++)$buttons[o].remove();create_clone_button($parent,sortValue,lib=t.detail.choice.label,"list",""),create_clone_listener(sortValue)}update_cookie_filter(filters),iso.arrange(),updateFilterCounts()}function filter_list_multi(e,t,r){$evnt=t,$params=r,$isclone=!1,"clonedbuttons"==e.parentNode.id?($selectid="isotope-select-"+($parent=e.getAttribute("data-filter-group")),$isclone=!0):($parent=e.parentNode.parentNode.parentNode.getAttribute("data-filter-group"),$selectid=e.getAttribute("id")),void 0===filters[$parent]&&(filters[$parent]=[]);var o=document.querySelector("joomla-field-fancy-select#"+$selectid).choicesInstance;if("remove"==$params){if($isclone){removeFilter(filters,$parent,e.getAttribute("data-sort-value")),savfilter=JSON.parse(JSON.stringify(filters)),o.removeActiveItems(),filters=JSON.parse(JSON.stringify(savfilter)),o.removeActiveItemsByValue("");for(var a=0;a<filters[$parent].length;a++)$val=filters[$parent][a],o.setChoiceByValue($val)}else removeFilter(filters,$parent,$evnt.detail.value),(myclone=document.querySelector('#clonedbuttons button[data-sort-value="'+$evnt.detail.value+'"]'))&&myclone.remove();0==filters[$parent].length&&(filters[$parent]=["*"],o.setChoiceByValue(""))}if($needclone=!1,"offcanvas-body"==($grdparent=e.parentNode.parentNode.parentNode.parentNode.parentNode).classList[0]&&($needclone=!0),"choice"==$params){if(sel=$evnt.detail.choice.value,lib=$evnt.detail.choice.label,""==sel){filters[$parent]=["*"],o.removeActiveItems(),o.setChoiceByValue(""),$buttons=document.querySelectorAll('#clonedbuttons [data-filter-group="'+$parent+'"]');for(var a=0;a<$buttons.length;a++)$buttons[a].remove()}else -1!=filters[$parent].indexOf("*")&&(o.removeActiveItemsByValue(""),filters[$parent]=[]),$needclone&&(create_clone_button($parent,sel,lib,"list_multi",""),create_clone_listener(sel)),addFilter(filters,$parent,sel);o.hideDropdown()}update_cookie_filter(filters),iso.arrange(),updateFilterCounts()}function filter_button(e,t){if(!hasClass(e,"disabled")){$parent=e.parentNode.getAttribute("data-filter-group"),child=e.getAttribute("data-child");var r=e.getAttribute("data-sort-value");if($isclone=!1,"clonedbuttons"==e.parentNode.id&&($parent=e.getAttribute("data-filter-group"),toggleClass(abutton=document.querySelector(".isotope_button-group .iso_button_"+$parent+"_"+r),"is-checked"),r="*",toggleClass(abutton=-1!=std_parents.indexOf($parent)?document.querySelector(".iso_button_"+$parent+"_tout"):document.querySelector(".iso_button_tout.filter-button-group-"+$parent),"is-checked"),$isclone=!0),void 0===filters[$parent]&&(filters[$parent]={}),$needclone=!1,hasClass($grdparent=e.parentNode.parentNode,"offcanvas-body")&&($needclone=!0),$needclone){if(hasClass(e,"is-checked"))return;$buttons=document.querySelectorAll('#clonedbuttons [data-filter-group="'+$parent+'"]');for(var o=0;o<$buttons.length;o++)$buttons[o].remove();"*"!=r&&(create_clone_button($parent,r,lib=t.srcElement.innerHTML,"button",child),create_clone_listener(r))}"*"==r?(filters[$parent]=["*"],$isclone&&e.remove,child&&set_family_all(me,child,"button")):(filters[$parent]=[r],child&&set_family(me,"",child,r,"button")),update_cookie_filter(filters),iso.arrange(),updateFilterCounts()}}function filter_multi(e,t){var r=e.getAttribute("data-sort-value");if(child=e.getAttribute("data-child"),$isclone=!1,"clonedbuttons"==e.parentNode.id){$parent=e.getAttribute("data-filter-group"),$buttons=document.querySelectorAll(".iso_button_"+$parent+"_"+r);for(var o=0;o<$buttons.length;o++)toggleClass($buttons[o],"is-checked");$isclone=!0}else $parent=e.parentNode.getAttribute("data-filter-group"),toggleClass(e,"is-checked");var a=hasClass(e,"is-checked");if($needclone=!1,hasClass($grdparent=e.parentNode.parentNode,"offcanvas-body")&&($needclone=!0),$needclone&&(a?(create_clone_button($parent,r,lib=t.srcElement.innerHTML,"multi",child),create_clone_listener(r)):(aclone=document.querySelector("#clonedbuttons .iso_button_"+$parent+"_"+r)).remove()),void 0===filters[$parent]&&(filters[$parent]=[]),"*"==r){filters[$parent]=["*"],clones=document.querySelectorAll('#clonedbuttons [data-filter-group="'+$parent+'"]');for(var o=0;o<clones.length;o++)clones[o].remove();child&&set_family_all(me,child,"button")}else removeFilter(filters,$parent,"*"),removeFilter(filters,$parent,"none"),a?(addFilter(filters,$parent,r),child&&set_family(me,$parent,child,r,"button")):(removeFilter(filters,$parent,r),0==filters[$parent].length&&(filters[$parent]=["*"],$isclone&&addClass(aclone=document.querySelector(".filter-button-group-"+$parent+' [data-sort-value="*"]'),"is-checked")),child&&(filters[$parent]==["*"]?set_family_all(me,child,"button"):del_family(me,$parent,child,r,"button")));update_cookie_filter(filters),iso.arrange(),updateFilterCounts()}function set_buttons_multi(e){if($parent=e.parentNode.getAttribute("data-filter-group"),"*"==e.getAttribute("data-sort-value")){buttons=e.parentNode.querySelectorAll("button.is-checked");for(var t=0;t<buttons.length;t++)removeClass(buttons[t],"is-checked");addClass(e,"is-checked")}else 0==filters[$parent].length||"*"==filters[$parent]?(addClass(button_all=e.parentNode.querySelector('[data-sort-value="*"]'),"is-checked"),filters[$parent]=["*"],update_cookie_filter(filters),iso.arrange()):removeClass(button_all=e.parentNode.querySelector('[data-sort-value="*"]'),"is-checked")}function updateFilterCounts(){for(var e=document.querySelectorAll(me+".isotope_item"),t=document.querySelector(me+".iso_button_more"),r=iso.getFilteredItemElements(),o=r.length,a=document.querySelector(me+".iso_div_empty"),n=0;n<e.length;n++)hasClass(e[n],"iso_hide_elem")&&removeClass(e[n],"iso_hide_elem");if(empty_message&&(0==o?removeClass(a,"iso_hide_elem"):hasClass(a,"iso_hide_elem")||addClass(a,"iso_hide_elem")),items_limit>0){for(var u=0;u<r.length;u++)u>=items_limit&&addClass(e[u],"iso_hide_elem");u<items_limit&&"infinite"!=options.pagination?addClass(t,"iso_hide_elem"):removeClass(t,"iso_hide_elem")}if(0==items_limit&&sav_limit>0&&"infinite"!=options.pagination){for(var u=0;u<r.length;u++)hasClass(r[u],"iso_hide_elem")&&(o-=1);o>sav_limit?removeClass(t,"iso_hide_elem"):addClass(t,"iso_hide_elem")}iso.arrange()}function create_clone_button(e,t,r,o,a){buttons=document.querySelector("#clonedbuttons");var n=document.createElement("button");n.classList.add("btn"),n.classList.add("btn-sm"),n.classList.add("iso_button_"+e+"_"+t),n.classList.add("is-checked"),n.setAttribute("data-sort-value",t),n.setAttribute("data-filter-group",e),n.setAttribute("data-clone-type",o),a&&n.setAttribute("data-child",a),n.title=r,n.innerHTML=r,buttons.prepend(n)}function create_clone_listener(e){(onebutton=document.querySelector('#clonedbuttons [data-sort-value="'+e+'"] ')).addEventListener("click",function(e){"multi"==this.getAttribute("data-clone-type")&&filter_multi(this),"button"==this.getAttribute("data-clone-type")&&filter_button(this),"list_multi"==this.getAttribute("data-clone-type")&&filter_list_multi(this,e,"remove"),"list"==this.getAttribute("data-clone-type")&&filter_list(this,e),this.remove()})}function debounce(e,t){var r;return function o(){r&&clearTimeout(r),r=setTimeout(function t(){e(),r=null},t||100)}}function addFilter(e,t,r){-1==e[t].indexOf(r)&&e[t].push(r)}function removeFilter(e,t,r){Array.isArray(e[t])||(e[t]=["*"]);var o=e[t].indexOf(r);-1!=o&&e[t].splice(o,1)}function update_cookie_filter(e){for(x in $filter_cookie="",e)$filter_cookie.length>0&&($filter_cookie+=">"),$filter_cookie+=x+"<"+e[x].toString();$filter_cookie.length>0&&($filter_cookie+=">"),CG_Cookie_Set(myid,"filter",$filter_cookie)}function getCookie(e){let t=document.cookie.match(RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):""}function CG_Cookie_Set(e,t,r){$secure="","https:"==window.location.protocol&&($secure="secure;"),lecookie=getCookie(cookie_name),$cook=$val=t+":"+r,""!=lecookie&&(lecookie.indexOf(t)>=0?($cook="",($arr=lecookie.split("&")).forEach(replaceCookie,$val)):$cook=lecookie+"&"+$val),document.cookie=cookie_name+"="+$cook+"; path=/; samesite=lax;"+$secure}function replaceCookie(e,t,r){this.startsWith("search:")&&e.indexOf("search:")>=0&&(r[t]=this),this.startsWith("sort:")&&e.indexOf("sort:")>=0&&(r[t]=this),this.startsWith("filter:")&&e.indexOf("filter:")>=0&&(r[t]=this),this.startsWith("range:")&&e.indexOf("range:")>=0&&(r[t]=this),$cook.length>0&&($cook+="&"),$cook+=r[t]}function splitCookie(e){if(me="#isotope-main-"+myid+" ",quicksearch=document.querySelector(me+".quicksearch"),e.indexOf("search:")>=0&&"undefined"!=typeof quicksearch&&(qsRegex=RegExp((val=e.split(":"))[1],"gi"),quicksearch.value=val[1]),e.indexOf("sort:")>=0){for(i=0,sort_by=(val=(val=e.split(":"))[1].split("-"))[0].split(","),asc="true"==val[1],sortAsc={};i<sort_by.length;i++)"featured"==sort_by[i]?sortAsc[sort_by[i]]=!1:sortAsc[sort_by[i]]=asc;for(s=0,asc=sortAsc,sortButtons=document.querySelectorAll(me+".sort-by-button-group button");s<sortButtons.length;s++)"*"!=val[0]&&(sortButtons[s].classList.remove("is-checked"),sortButtons[s].getAttribute("data-sort-value")==val[0]&&(sortButtons[s].classList.add("is-checked"),sortButtons[s].setAttribute("data-sens","+"),"true"!=val[1]&&sortButtons[s].setAttribute("data-sens","-")))}if(e.indexOf("filter:")>=0&&(val=e.split(":"))[1].length>0){for(x=0,val=val[1].split(">");x<val.length-1;x++)if(values=val[x].split("<"),-1!=std_parents.indexOf(values[0])){if("tags"==values[0]&&"listmulti"==options.displayfiltertags||"cat"==values[0]&&"listmulti"==options.displayfiltercat){var t=document.querySelector("joomla-field-fancy-select#isotope-select-"+values[0]),r=t.choicesInstance;if(filters[values[0]]=values[1].split(","),"*"==values[1])r.setChoiceByValue("");else{for(r.removeActiveItemsByValue(""),vals=values[1].split(","),c=0;c<vals.length;c++)r.setChoiceByValue(vals[c]);if("offcanvas-body"==t.parentElement.parentElement.className)for(c=0;c<r.getValue().length;c++)lib=r.getValue()[c].label,sel=r.getValue()[c].value,child=null,create_clone_button(values[0],sel,lib,"list_multi",child),create_clone_listener(sel)}}else if("*"!=values[1]){for(f=0,filters[values[0]]=values[1].split(","),filterButtons="lang"==values[0]?document.querySelectorAll(me+".iso_lang button.is-checked"):document.querySelectorAll(me+".filter-button-group-"+values[0]+" button.is-checked");f<filterButtons.length;f++)filterButtons[f].classList.remove("is-checked");for(v=0;v<filters[values[0]].length;v++)if("tags"==values[0]&&"list"==options.displayfiltertags||"cat"==values[0]&&"list"==options.displayfiltercat){var t=document.querySelector("joomla-field-fancy-select#isotope-select-"+values[0]),r=t.choicesInstance;if(r.setChoiceByValue(filters[values[0]][v]),"offcanvas-body"==t.parentElement.parentElement.className){var r=t.choicesInstance;sel=filters[values[0]][v],lib=r.getValue().label,child=null,create_clone_button(values[0],sel,lib,"list",child),create_clone_listener(sel)}}else addClass($button=document.querySelector(me+".iso_button_"+values[0]+"_"+filters[values[0]][v]),"is-checked"),hasClass($button.parentNode.parentNode,"offcanvas-body")&&($type="button",("cat"==values[0]&&("multi"==options.displayfiltercat||"multiex"==options.displayfiltercat)||"tags"==values[0]&&("multi"==options.displayfiltertags||"multiex"==options.displayfiltercat)||"alpha"==values[0]&&("multi"==options.displayalpha||"multiex"==options.displayalpha))&&($type="multi"),child=null,lib=$button.innerHTML,create_clone_button(values[0],filters[values[0]][v],lib,$type,child),create_clone_listener(filters[values[0]][v]))}}else if("listmulti"==options.displayfilterfields){var t=document.querySelector("joomla-field-fancy-select#isotope-select-"+values[0]),r=t.choicesInstance;if(filters[values[0]]=values[1].split(","),"*"==values[1])r.setChoiceByValue("");else{for(r.removeActiveItemsByValue(""),vals=values[1].split(","),c=0;c<vals.length;c++)r.setChoiceByValue(vals[c]);if("offcanvas-body"==t.parentElement.parentElement.className)for(c=0;c<r.getValue().length;c++)lib=r.getValue()[c].label,sel=r.getValue()[c].value,child=null,create_clone_button(values[0],sel,lib,"list",child),create_clone_listener(sel)}}else if("*"!=values[1]){for(l=0,alist=document.querySelectorAll(me+".class_fields_"+values[0]+" .is-checked");l<alist.length;l++)alist[l].classList.remove("is-checked");for(v=0,filters[values[0]]=values[1].split(",");v<filters[values[0]].length;v++)"list"==options.displayfilterfields||"listex"==options.displayfilterfields?(r=(t=document.querySelector("joomla-field-fancy-select#isotope-select-"+values[0])).choicesInstance,filters[values[0]]=values[1].split(","),"*"==values[1]?r.setChoiceByValue(""):(r.removeActiveItemsByValue(""),r.setChoiceByValue(values[1]),"offcanvas-body"==t.parentElement.parentElement.parentElement.className&&(lib=r.getValue().label,sel=r.getValue().value,child=null,create_clone_button(values[0],sel,lib,"list",child),create_clone_listener(sel)))):(addClass($this=document.querySelector(me+".iso_button_"+values[0]+"_"+filters[values[0]][v]),"is-checked"),(child=$this.getAttribute("data-child"))&&set_family(me,"",child,sortValue=$this.getAttribute("data-sort-value"),"button"),hasClass($this.parentNode.parentNode.parentNode,"offcanvas-body")&&($type="button",lib=$this.innerHTML,create_clone_button(values[0],filters[values[0]][v],lib,$type,child),create_clone_listener(filters[values[0]][v])))}}e.indexOf("range:")>=0&&(val=e.split(":"))[1].length>0&&(min_range=parseInt((spl=val[1].split(","))[0]),max_range=parseInt(spl[1]))}function set_family(e,t,r,o,a){for(parents=[];r;){if("list"==a){listoptions=($this=document.querySelector(e+'.filter-button-group-fields [data-group-id="'+r+'"]')).querySelectorAll("option");for(var n=0;n<listoptions.length;n++)hasClass(listoptions[n],"iso_hide_elem")||addClass(listoptions[n],"iso_hide_elem");removeClass($all=$this.querySelector('[data-all="all"]'),"iso_hide_elem"),$all.setAttribute("selected",!0),r=$all.getAttribute("data-child")}else{if($this=($myparent=document.querySelector(e+".filter-button-group-fields").parentNode).querySelector('[data-group-id="'+r+'"]'),""==t||""!=t&&1==filters[t].length&&"*"!=filters[t]){buttons=$this.querySelectorAll("button");for(var n=0;n<buttons.length;n++)hasClass(buttons[n],"iso_hide_elem")||addClass(buttons[n],"iso_hide_elem"),removeClass(buttons[n],"is-checked")}removeClass(abutton=$this.querySelector("button.iso_button_tout"),"iso_hide_elem"),addClass(abutton,"is-checked"),r=abutton.getAttribute("data-child")}if(0==parents.length){buttons=$this.querySelectorAll('[data-parent="'+o+'"]');for(var n=0;n<buttons.length;n++)removeClass(buttons[n],"iso_hide_elem");if(newparents=$this.querySelectorAll('[data-parent="'+o+'"]'),parents=[],newparents.length>0)for($i=0;$i<newparents.length;$i++)"*"!=($val="list"==a?newparents[$i].getAttribute("value"):newparents[$i].getAttribute("data-sort-value"))&&parents.push($val)}else{for($i=0,newparents=[];$i<parents.length;$i++)if("*"!=(o=parents[$i])){buttons=$this.querySelectorAll('[data-parent="'+o+'"]');for(var n=0;n<buttons.length;n++)removeClass(buttons[n],"iso_hide_elem");if(($vals=$this.querySelectorAll('[data-parent="'+o+'"]')).length>0)for($j=0;$j<$vals.length;$j++)"*"!=($val="list"==a?$vals[$j].getAttribute("value"):$vals[$j].getAttribute("data-sort-value"))&&newparents.push($val)}parents=newparents}filters[childstr=$this.getAttribute("data-filter-group")]=["*"],o=""}}function del_family(e,t,r,o,a){for(parents=[];r;){if(addClass(abutton=($this=(myparent=document.querySelector(e+".filter-button-group-fields").parentNode).querySelector('[data-group-id="'+r+'"]')).querySelector('[data-parent="'+o+'"]'),"iso_hide_elem"),removeClass(abutton,"is-checked"),removeClass(abutton=$this.querySelector("button.iso_button_tout"),"iso_hide_elem"),addClass(abutton,"is-checked"),r=$this.getAttribute("data-child"),0==parents.length){if(newparents=$this.querySelectorAll('[data-parent="'+o+'"]'),parents=[],newparents.length>0)for($i=0;$i<newparents.length;$i++)"*"!=($val="list"==a?newparents[$i].getAttribute("value"):newparents[$i].getAttribute("data-sort-value"))&&(parents.push($val),addClass(newparents[$i],"iso_hide_elem"))}else{for($i=0,newparents=[];$i<parents.length;$i++)if("*"!=(o=parents[$i])&&($vals=$this.querySelectorAll('[data-parent="'+o+'"]')).length>0)for($j=0;$j<$vals.length;$j++)"*"!=($val="list"==a?$vals[$j].getAttribute("value"):$vals[$j].getAttribute("data-sort-value"))&&(newparents.push($val),addClass($vals[$j],"iso_hide_elem"));parents=newparents}filters[childstr=$this.getAttribute("data-filter-group")]=["*"],o=""}}function set_family_all(e,t,r){for(parents=[];t;){for(o=0,parents=($this="list"==r?document.querySelector(e+".filter-button-group-fields"):document.querySelector(e+".filter-button-group-fields").parentNode).querySelectorAll('[data-child="'+t+'"]');o<parents.length;o++)!hasClass(parents[o],"iso_hide_elem")&&($val="list"==r?parents[o].getAttribute("value"):parents[o].getAttribute("data-sort-value"))&&"*"!=$val&&removeClass($this.querySelector('[data-parent="'+$val+'"]'),"iso_hide_elem");if("list"==r)allbuton=$this.querySelector('[data-group-id="'+t+'"] [data-all="all"]'),t=allbutton.getAttribute("data-child");else{buttons=$this.querySelectorAll('[data-group-id="'+t+'"] button');for(var o=0;o<buttons.length;o++)removeClass(buttons[o],"is-checked");addClass($this.querySelector('[data-group-id="'+t+'"] button.iso_button_tout'),"is-checked"),myparent=$mychild=$this.querySelector('[data-group-id="'+t+'"]'),t=($mychild_all=$mychild.querySelector("button.iso_button_tout")).getAttribute("data-child")}filters[childstr=$this.getAttribute("data-filter-group")]=["*"]}}function go_click(e,t){event.preventDefault(),"webLinks"==e||window.event.ctrlKey?window.open(t,"_blank"):location=t}document.addEventListener("DOMContentLoaded",function(){mains=document.querySelectorAll(".isotope-main");for(var e=0;e<mains.length;e++){if(myid=mains[e].getAttribute("data"),"undefined"==typeof Joomla||void 0===Joomla.getOptions)return console.error("Joomla.getOptions not found!\nThe Joomla core.js file is not being loaded."),!1;if(void 0===(options=Joomla.getOptions("cg_isotope_"+myid)))return!1;cookie_name="cg_isotope_"+myid,iso_cat_k2(myid,options)}if(grid_toggle=document.querySelector(".isotope_grid"),iso_article=document.querySelector(".isotope_an_article"),iso_div=document.querySelector(".isotope-main .isotope-div"),article_frame=document.querySelector("iframe#isotope_article_frame"),"ajax"==options.readmore||"iframe"==options.readmore){iso_height=grid_toggle.offsetHeight,iso_width=grid_toggle.offsetWidth,readmoretitles=document.querySelectorAll(".isotope-readmore-title");for(var t=0;t<readmoretitles.length;t++)["click","touchstart"].forEach(e=>{readmoretitles[t].addEventListener(e,function(e){($pos=iso_div.offsetTop,document.querySelector("body").scrollTo($pos,1e3),e.stopPropagation(),e.preventDefault(),addClass(grid_toggle,"isotope-hide"),addClass(iso_article,"isotope-open"),removeClass(iso_article,"isotope-hide"),iso_article.offsetHeight="auto",addClass(iso_article,"article-loading"),"ajax"==options.readmore)?(document.querySelector("#isotope_an_article").innerHTML="",token=document.getElementById("token").getAttribute("name"),$.ajax({data:{[token]:"1",task:"display",format:"json",article:this.dataset.articleid,entree:options.entree},success:function(e,t,r){removeClass(iso_article,"article-loading"),iso_article.style.height=iso_height,iso_article.style.width=iso_width+"px",e.success||(e.success=!0),displayArticle(e)},error:function(e){console.log(e.responseText)}})):"iframe"==options.readmore&&(0==iso_height&&(iso_height="100vh"),article_frame.style.height=0,article_frame.style.width=0,achar="?",this.dataset.href.indexOf("?")>0&&(achar="&"),article_frame.setAttribute("src",this.dataset.href+achar+"tmpl=component"),addClass(iso_article,"article-loading"),addClass($close=document.querySelector("button.close"),"isotope-hide"),["click","touchstart"].forEach(e=>{$close.addEventListener(e,function(){resetToggle()})})),["click","touchstart"].forEach(e=>{grid_toggle.addEventListener(e,function(){resetToggle()})})})})}["click","touchstart"].forEach(e=>{iso_div.addEventListener(e,function(){resetToggle()})}),resetToggle=function(){grid_toggle&&hasClass(grid_toggle,"isotope-hide")?(removeClass(iso_article,"isotope-open"),addClass(iso_article,"isotope-hide"),removeClass(grid_toggle,"isotope-hide"),iso_div.refresh):iso_article&&hasClass(iso_article,"isotope-open")&&(removeClass(iso_article,"isotope-open"),addClass(iso_article,"isotope-hide"),iso_article.innerHTML(""),iso_div.refresh)},article_frame&&article_frame.addEventListener("load",function(){removeClass(iso_article,"article-loading"),$close&&removeClass($close,"isotope-hide"),article_frame.style.height=iso_height,article_frame.style.width=iso_width+"px"})}),hasClass=function(e,t){var r=RegExp("(?:\\s|^)"+t+"(?:\\s|$)");return!!e.className.match(r)},addClass=function(e,t){e.className+=" "+t},removeClass=function(e,t){var r=RegExp("(?:\\s|^)"+t+"(?:\\s|$)");e.className=e.className.replace(r," ")},toggleClass=function(e,t){hasClass(e,t)?removeClass(e,t):addClass(e,t)};var scrollTo=function(e,t){var r=document.scrollingElement||document.documentElement,o=r.scrollTop,a=e-o,n=performance.now(),u=function(d){var g,p,m,h,y=d-n;r.scrollTop=parseInt((g=y,p=o,m=a,(g/=(h=t)/2)<1?m/2*g*g+p:-m/2*(--g*(g-2)-1)+p)),y<t?requestAnimationFrame(u):r.scrollTop=e};requestAnimationFrame(u)};