var $close,grid_toggle,iso_article,iso,me,empty_message,items_limit,sav_limit,iso_height,iso_width,article_frame,resetToggle,options,myid,qsRegex,asc,sort_by,filters,rangeSlider,range_init,range_sel,min_range,max_range,cookie_name,std_parents=["cat","tags","lang","alpha"];function displayArticle(e){var t="";if(e.success){for(var s=0;s<e.length;s++){if(t+="<h1>"+e[s].title+'<button type="button" class="close">X</button></h1>',"k2"==options.entree&&e[s].image&&(t+='<span class="itemImage"><a class="moduleItemImage" href="'+e[s].link+'">',t+='<img src="'+e[s].image+'" alt="'+e[s].title+'" /></a></span>'),t+=e[s].fulltext,""==e[s].fulltext&&(t+=e[s].introtext),"k2"==options.entree&&e[s].extra_fields){if(t+='<div class="itemExtraFields"><ul>',Array.isArray(e[s].extra_fields)){$l=e[s].extra_fields.length;for(var l=0;l<$l;l++)t+='<li class="typeTextfield">',t+='<span class="itemExtraFieldsLabel">'+e[s].extra_fields[l].name+"</span>",t+='<span class="itemExtraFieldsValue">'+e[s].extra_fields[l].value+"</span>",t+="</li>"}else for(var l in $l=Object.values(e[s].extra_fields).length,e[s].extra_fields)t+='<li class="typeTextfield">',t+='<span class="itemExtraFieldsLabel">'+e[s].extra_fields[l].name+"</span>",t+='<span class="itemExtraFieldsValue">'+e[s].extra_fields[l].value+"</span>",t+="</li>";t+="</ul></div>"}if(e[s].scripts.length>0)for(var a=0;a<e[s].scripts.length;a++){var i=document.createElement("script");i.addEventListener("load",function(){console.log("Successfully loaded scripts")}),i.src=e[s].scripts[a],document.head.appendChild(i)}if(e[s].css.length>0)for(a=0;a<e[s].css.length;a++){var o=document.createElement("link");o.type="text/css",o.rel="stylesheet",o.addEventListener("load",function(){console.log("Successfully loaded css")}),o.href=e[s].css[a],document.head.appendChild(o)}}iso_article.innerHTML=t,$close=document.querySelector("button.close"),["click","touchstart"].forEach(e=>{$close.addEventListener(e,resetToggle)})}else if(t=e.message,e.messages&&e.messages.error)for(var r=0;r<e.messages.error.length;r++)t+="<br/>"+e.messages.error[r]}function iso_cat_k2(e,t){if(me="#isotope-main-"+e+" ",items_limit=t.limit_items,sav_limit=t.limit_items,empty_message="true"==t.empty,filters={},asc="true"==t.ascending,-1!==(sort_by=t.sortby).indexOf("featured"))for(sortValue=sort_by.split(","),asc={},r=0;r<sortValue.length;r++)"featured"==sortValue[r]?asc[sortValue[r]]=!1:asc[sortValue[r]]="true"==t.ascending;0==t.limit_items&&(document.querySelector(me+".iso_button_more").style.display="none"),""==t.default_cat||null==t.default_cat||void 0===t.default_cat?filters.cat=["*"]:filters.cat=[t.default_cat],""==t.default_tag||null==t.default_tag||void 0===t.default_tag?filters.tags=["*"]:filters.tags=[t.default_tag],filters.lang=["*"],filters.alpha=["*"];var s=getCookie(cookie_name);""!=s&&($arr=s.split("&"),$arr.forEach(splitCookie)),"masonry"!=t.layout&&"fitRows"!=t.layout&&"packery"!=t.layout||(document.querySelector("#isotope-main-"+e+" .isotope_item").style.width=100/parseInt(t.nbcol)-2+"%"),"vertical"==t.layout&&(document.querySelector("#isotope-main-"+e+" .isotope_item").style.width="100%"),document.querySelector("#isotope-main-"+e+" .isotope_item").style.background=t.background,parseInt(t.imgmaxheight)>0&&(document.querySelector("#isotope-main-"+e+" .isotope_item img").style["max-height"]=t.imgmaxheight+"px"),parseInt(t.imgmaxwidth)>0&&(document.querySelector("#isotope-main-"+e+" .isotope_item img").style["max-width"]=t.imgmaxwidth+"px"),"true"==t.displayrange&&(min_range||(min_range=parseInt(t.minrange),max_range=parseInt(t.maxrange)),rangeSlider=new rSlider({target:"#rSlider",values:{min:parseInt(t.minrange),max:parseInt(t.maxrange)},step:parseInt(t.rangestep),set:[min_range,max_range],range:!0,tooltip:!0,scale:!0,labels:!0,onChange:rangeUpdated})),"string"==typeof sort_by&&(sort_by=sort_by.split(","));var l=document.querySelector(me+".isotope_grid");if(iso=new Isotope(l,{itemSelector:"none",percentPosition:!0,layoutMode:t.layout,getSortData:{title:"[data-title]",category:"[data-category]",date:"[data-date]",click:"[data-click] parseInt",rating:"[data-rating] parseInt",id:"[data-id] parseInt",featured:"[data-featured] parseInt"},sortBy:sort_by,sortAscending:asc,isJQueryFiltering:!1,filter:function(e){if(e)return grid_filter(e)}}),imagesLoaded(l,function(){iso.options.itemSelector=".isotope_item";var e=Array.prototype.slice.call(iso.element.querySelectorAll(".isotope_item"));iso.appended(e),"random"==sort_by?iso.shuffle():iso.arrange(),updateFilterCounts(),"undefined"!=typeof $toogle&&(iso_width=grid_toggle.width(),iso_height=grid_toggle.height())}),iso_div=document.querySelector(me+".isotope-div"),iso_div.addEventListener("refresh",function(){iso.arrange()}),"infinite"==t.pagination){var a=Isotope.data(".isotope_grid"),i=new InfiniteScroll(".isotope_grid",{path:function(){return currentpage=this.loadCount,"?start="+(currentpage+1)*t.page_count},append:".isotope_item",outlayer:a,status:".page-load-status"});let e=document.querySelector(me+".iso_button_more");if("true"==t.infinite_btn){i.option({button:".iso_button_more",loadOnScroll:!1});let t=document.querySelector(".iso_button_more");e.style.display="block",t.addEventListener("click",function(){i.loadNextPage(),i.option({loadOnScroll:!0}),t.style.display="none"})}else e.style.display="hide";i.on("append",function(e,t,s,l){infinite_buttons(s)})}hamburgerbtn=document.getElementById("offcanvas-hamburger-btn"),hamburgerbtn&&hamburgerbtn.addEventListener("click",function(){var e=function(t,s=!1){!1===s||s>0?(0!=s&&s--,setTimeout(function(){e(t,s)},100)):(void 0!==rangeSlider&&rangeSlider.onResize(),t())};e(function(){document.querySelector(".offcanvas")},3)});for(var o=document.querySelectorAll(me+".sort-by-button-group button"),r=0;r<o.length;r++)o[r].addEventListener("click",function(){update_sort_buttons(this);for(var e=0;e<o.length;e++)o[e].classList.remove("is-checked");this.classList.add("is-checked")});var n=document.querySelector(me+".quicksearch");n.addEventListener("keyup",debounce(function(){qsRegex=new RegExp(n.value,"gi"),CG_Cookie_Set(e,"search",n.value),iso.arrange(),updateFilterCounts()})),document.querySelector(me+".ison-cancel-squared").addEventListener("click",function(){n.value="",qsRegex=new RegExp(n.value,"gi"),CG_Cookie_Set(e,"search",n.value),rangeSlider&&(range_sel=range_init,ranges=range_sel.split(","),rangeSlider.setValues(parseInt(ranges[0]),parseInt(ranges[1])),CG_Cookie_Set(e,"range",range_sel)),filters.cat=["*"],filters.tags=["*"],filters.lang=["*"],filters.alpha=["*"],grouptype=["cat","tags","fields","alpha"];for(var t=0;t<grouptype.length;t++){agroup=document.querySelectorAll(me+".filter-button-group-"+grouptype[t]+" .btn");for(var s=0;s<agroup.length;s++)agroup[s].classList.remove("is-checked"),"*"==agroup[s].getAttribute("data-sort-value")&&addClass(agroup[s],"is-checked"),"all"==agroup[s].getAttribute("data-all")&&agroup[s].setAttribute("selected",!0),"fields"==grouptype[t]&&(removeClass(agroup[s],"iso_hide_elem"),myparent=agroup[s].parentNode.getAttribute("data-filter-group"),filters[myparent]="*")}agroup=document.querySelectorAll(me+".iso_lang .btn");for(s=0;s<agroup.length;s++)agroup[s].classList.remove("is-checked"),"*"==agroup[s].getAttribute("data-sort-value")&&addClass(agroup[s],"is-checked"),"all"==agroup[s].getAttribute("data-all")&&agroup[s].setAttribute("selected",!0);agroup=document.querySelectorAll(me+'select[id^="isotope-select-"]');for(s=0;s<agroup.length;s++){$val=agroup[s].parentElement.parentElement.parentElement.getAttribute("data-filter-group");var l=document.querySelector("joomla-field-fancy-select#isotope-select-"+$val).choicesInstance;l.removeActiveItems(),l.setChoiceByValue(""),filters[$val]=["*"]}$buttons=document.querySelectorAll("#clonedbuttons .is-checked");for(s=0;s<$buttons.length;s++)$buttons[s].remove();update_cookie_filter(filters),iso.arrange(),updateFilterCounts(),document.querySelector(me+".quicksearch").focus()}),"listmulti"==t.displayfiltertags&&events_listmulti("tags"),"listmulti"==t.displayfiltercat&&events_listmulti("cat"),"listmulti"==t.displayfilterfields&&events_listmulti("fields"),"list"!=t.displayfiltercat&&"listex"!=t.displayfiltercat||events_list("cat"),"list"!=t.displayfiltertags&&"listex"!=t.displayfiltertags||events_list("tags"),"list"!=t.displayfilterfields&&"listex"!=t.displayfilterfields||events_list("fields"),"multi"!=t.displayfiltercat&&"multiex"!=t.displayfiltercat||events_multibutton("cat"),"multi"!=t.displayfiltertags&&"multiex"!=t.displayfiltertags||events_multibutton("tags"),"multi"!=t.displayfilterfields&&"multiex"!=t.displayfilterfields||events_multibutton("fields"),"multi"==t.language_filter&&events_multibutton("lang"),"multi"==t.displayalpha&&events_multibutton("alpha"),"button"==t.displayfiltercat&&events_button("cat"),"button"==t.displayfiltertags&&events_button("tags"),"button"==t.displayfilterfields&&events_button("fields"),"button"==t.language_filter&&events_button("lang"),"button"==t.displayalpha&&events_button("alpha"),more=document.querySelector(me+".iso_button_more"),more.addEventListener("click",function(e){e.preventDefault(),items_limit>0?(items_limit=0,this.textContent=t.libless):(items_limit=t.limit_items,this.textContent=t.libmore),updateFilterCounts()});var c=document.getElementById("offcanvas_isotope");c&&(c.addEventListener("hidden.bs.offcanvas",function(){document.getElementById("offcanvas_isotope").classList.remove("offcanvas25"),document.getElementsByClassName("isotope_grid")[0].classList.remove("isogrid75"),document.getElementsByClassName("isotope_grid")[0].classList.remove("offstart"),document.getElementsByClassName("isotope_grid")[0].classList.remove("offend"),iso.arrange()}),c.addEventListener("show.bs.offcanvas",function(){document.getElementById("offcanvas_isotope").classList.add("offcanvas25"),document.getElementById("offcanvas_isotope").classList.contains("offcanvas-start")&&document.getElementsByClassName("isotope_grid")[0].classList.add("offstart"),document.getElementById("offcanvas_isotope").classList.contains("offcanvas-end")&&document.getElementsByClassName("isotope_grid")[0].classList.add("offend"),iso.arrange()}))}function rangeUpdated(){range_sel=rangeSlider.getValue(),range_init=rangeSlider.conf.values[0]+","+rangeSlider.conf.values[rangeSlider.conf.values.length-1],CG_Cookie_Set(myid,"range",range_sel),iso.arrange()}function events_listmulti(e){agroup=document.querySelectorAll(me+'select[id^="isotope-select-'+e+'"]');for(var t=0;t<agroup.length;t++)agroup[t].addEventListener("choice",function(e,t){filter_list_multi(this,e,"choice")}),agroup[t].addEventListener("removeItem",function(e,t){filter_list_multi(this,e,"remove")}),$parent=agroup[t].parentElement.parentElement.parentElement.getAttribute("data-filter-group"),void 0===filters[$parent]&&(filters[$parent]=["*"])}function events_list(e){agroup=document.querySelectorAll(me+".filter-button-group-"+e);for(var t=0;t<agroup.length;t++)agroup[t].addEventListener("choice",function(e,t){filter_list(this,e,"choice")}),agroup[t].addEventListener("removeItem",function(e,t){filter_list(this,e,"remove")})}function events_button(e){agroup="lang"==e?document.querySelectorAll(me+".iso_lang button"):document.querySelectorAll(me+".filter-button-group-"+e+" button");for(var t=0;t<agroup.length;t++)["click","touchstart"].forEach(e=>{agroup[t].addEventListener(e,function(e){filter_button(this,e),mygroup=this.parentNode.querySelectorAll("button");for(var t=0;t<mygroup.length;t++)removeClass(mygroup[t],"is-checked");addClass(this,"is-checked")})})}function events_multibutton(e){agroup="lang"==e?document.querySelectorAll(me+".iso_lang button"):document.querySelectorAll(me+".filter-button-group-"+e+" button");for(var t=0;t<agroup.length;t++)["click","touchstart"].forEach(e=>{agroup[t].addEventListener(e,function(e){filter_multi(this,e)})});for(t=0;t<agroup.length;t++)agroup[t].addEventListener("click",function(){set_buttons_multi(this)})}function update_sort_buttons(e){var t=e.getAttribute("data-sort-value");if("random"==t)return CG_Cookie_Set(myid,"sort",t+"-"),void iso.shuffle();for(sens=e.getAttribute("data-sens"),t=t.split(","),hasClass(e,"is-checked")?"-"==sens?(e.setAttribute("data-sens","+"),asc=!0):(e.setAttribute("data-sens","-"),asc=!1):(sens=e.getAttribute("data-init"),e.setAttribute("data-sens",sens),asc=!0,"-"==sens&&(asc=!1)),sortAsc={},i=0;i<t.length;i++)"featured"==t[i]?sortAsc[t[i]]=!1:sortAsc[t[i]]=asc;CG_Cookie_Set(myid,"sort",t+"-"+asc),iso.options.sortBy=t,iso.options.sortAscending=sortAsc,iso.arrange()}function infinite_buttons(e){if("false"!=options.displayalpha)for(x=0;x<e.length-1;x++)if(alpha=e[x].attributes["data-alpha"].value,mybutton=document.querySelector(me+".filter-button-group-alpha .iso_button_alpha_"+alpha),!mybutton){buttons=document.querySelector(me+".filter-button-group-alpha");var t=document.createElement("button");t.classList.add("btn"),t.classList.add(options.button_bootstrap.substr(4,100).trim()),t.classList.add("iso_button_alpha_"+alpha),t.setAttribute("data-sort-value",alpha),t.title=alpha,t.innerHTML=alpha,buttons.append(t)}}function grid_filter(e){var t=!qsRegex||e.textContent.match(qsRegex),s=e.getAttribute("data-category"),l=e.getAttribute("class").split(" "),a=!1,i=!0;if(-1==filters.alpha.indexOf("*")&&(alpha=e.getAttribute("data-title").substring(0,1),-1==filters.alpha.indexOf(alpha)))return!1;if(-1==filters.lang.indexOf("*")&&(lalang=e.getAttribute("data-lang"),-1==filters.lang.indexOf(lalang)))return!1;if(rangeSlider){var o=e.getAttribute("data-range");range_sel!=range_init&&(ranges=range_sel.split(","),i=parseInt(o)>=parseInt(ranges[0])&&parseInt(o)<=parseInt(ranges[1]))}if("fields"!=options.article_cat_tag&&"catfields"!=options.article_cat_tag&&"tagsfields"!=options.article_cat_tag&&"cattagsfields"!=options.article_cat_tag){if(-1!=filters.cat.indexOf("*")&&-1!=filters.tags.indexOf("*"))return t&&i&&!0;if(count=0,-1==filters.cat.indexOf("*")){if(-1==filters.cat.indexOf(s))return!1;count=1}if(-1!=filters.tags.indexOf("*"))return t&&i&&!0;for(var r in l)-1!=filters.tags.indexOf(l[r])&&(a=!0,count+=1);return"true"==options.searchmultiex?(lgth=filters.cat.length+filters.tags.length,-1==filters.tags.indexOf("*")&&-1==filters.cat.indexOf("*")||(lgth-=1),t&&i&&count==lgth):t&&i&&a}if(ix=0,void 0===filters)return t&&i&&!0;for(x in filterslength=0,filters)"cat"!=x&&"lang"!=x&&"alpha"!=x&&"tags"!=x&&(filterslength++,-1!=filters[x].indexOf("*")&&ix++);if(catok=!1,-1==filters.cat.indexOf("*")){if(-1==filters.cat.indexOf(s))return!1;catok=!0}else catok=!0;if(tagok=!1,-1==filters.tags.indexOf("*"))for(var r in l)-1!=filters.tags.indexOf(l[r])&&(tagok=!0);else tagok=!0;if(ix==filterslength&&catok&&tagok)return t&&i&&!0;for(var n in count=0,l)for(x in filters)"cat"!=x&&"lang"!=x&&"alpha"!=x&&"tags"!=x&&-1!=filters[x].indexOf(l[n])&&(count+=1);if("true"==options.searchmultiex){for(x in lgth=0,filters)"cat"!=x&&"lang"!=x&&"alpha"!=x&&"tags"!=x&&(lgth+=filters[x].length,-1!=filters[x].indexOf("*")&&(lgth-=1));return t&&i&&count==lgth&&tagok}return t&&i&&count>=filterslength-ix&&catok&&tagok}function filter_list(e,t,s){if($parent=e.getAttribute("data-filter-group"),$isclone=!1,"clonedbuttons"==e.parentNode.id?($selectid=$parent,$isclone=!0,sortValue=""):($selectid=e.getAttribute("data-filter-group"),sortValue=e.querySelector(".is-highlighted"),sortValue=sortValue.dataset.value),"undefined"==typeof sortValue&&(sortValue=""),elChoice=document.querySelector("joomla-field-fancy-select#isotope-select-"+$selectid),choicesInstance=elChoice.choicesInstance,$needclone=!1,$grdparent=e.parentNode,"offcanvas-body"==$grdparent.className&&($needclone=!0),"remove"==s&&$needclone)return removeFilter(filters,$parent,t.detail.value),myclone=document.querySelector('#clonedbuttons button[data-sort-value="'+t.detail.value+'"]'),myclone&&myclone.remove(),void(0==filters[$parent].length&&(filters[$parent]=["*"],choicesInstance.setChoiceByValue(""),update_cookie_filter(filters)));if(""==sortValue){choicesInstance.removeActiveItems(),choicesInstance.setChoiceByValue(""),filters[$parent]=["*"],$buttons=document.querySelectorAll('#clonedbuttons [data-filter-group="'+$parent+'"]');for(var l=0;l<$buttons.length;l++)$buttons[l].remove()}else if(filters[$parent]=[sortValue],$needclone){$buttons=document.querySelectorAll('#clonedbuttons [data-filter-group="'+$parent+'"]');for(l=0;l<$buttons.length;l++)$buttons[l].remove();lib=t.detail.choice.label,create_clone_button($parent,sortValue,lib,"list",""),create_clone_listener(sortValue)}update_cookie_filter(filters),iso.arrange(),updateFilterCounts()}function filter_list_multi(e,t,s){$evnt=t,$params=s,$isclone=!1,"clonedbuttons"==e.parentNode.id?($parent=e.getAttribute("data-filter-group"),$selectid="isotope-select-"+$parent,$isclone=!0):($parent=e.parentNode.parentNode.parentNode.getAttribute("data-filter-group"),$selectid=e.getAttribute("id")),void 0===filters[$parent]&&(filters[$parent]=[]);var l=document.querySelector("joomla-field-fancy-select#"+$selectid).choicesInstance;if("remove"==$params){if($isclone){removeFilter(filters,$parent,e.getAttribute("data-sort-value")),savfilter=JSON.parse(JSON.stringify(filters)),l.removeActiveItems(),filters=JSON.parse(JSON.stringify(savfilter)),l.removeActiveItemsByValue("");for(var a=0;a<filters[$parent].length;a++)$val=filters[$parent][a],l.setChoiceByValue($val)}else removeFilter(filters,$parent,$evnt.detail.value),myclone=document.querySelector('#clonedbuttons button[data-sort-value="'+$evnt.detail.value+'"]'),myclone&&myclone.remove();0==filters[$parent].length&&(filters[$parent]=["*"],l.setChoiceByValue(""))}if($needclone=!1,$grdparent=e.parentNode.parentNode.parentNode.parentNode.parentNode,"offcanvas-body"==$grdparent.classList[0]&&($needclone=!0),"choice"==$params){if(sel=$evnt.detail.choice.value,lib=$evnt.detail.choice.label,""==sel){filters[$parent]=["*"],l.removeActiveItems(),l.setChoiceByValue(""),$buttons=document.querySelectorAll('#clonedbuttons [data-filter-group="'+$parent+'"]');for(a=0;a<$buttons.length;a++)$buttons[a].remove()}else-1!=filters[$parent].indexOf("*")&&(l.removeActiveItemsByValue(""),filters[$parent]=[]),$needclone&&(create_clone_button($parent,sel,lib,"list_multi",""),create_clone_listener(sel)),addFilter(filters,$parent,sel);l.hideDropdown()}update_cookie_filter(filters),iso.arrange(),updateFilterCounts()}function filter_button(e,t){if(!hasClass(e,"disabled")){$parent=e.parentNode.getAttribute("data-filter-group"),child=e.getAttribute("data-child");var s=e.getAttribute("data-sort-value");if($isclone=!1,"clonedbuttons"==e.parentNode.id&&($parent=e.getAttribute("data-filter-group"),abutton=document.querySelector(".isotope_button-group .iso_button_"+$parent+"_"+s),toggleClass(abutton,"is-checked"),s="*",-1!=std_parents.indexOf($parent)?abutton=document.querySelector(".iso_button_"+$parent+"_tout"):abutton=document.querySelector(".iso_button_tout.filter-button-group-"+$parent),toggleClass(abutton,"is-checked"),$isclone=!0),void 0===filters[$parent]&&(filters[$parent]={}),$needclone=!1,$grdparent=e.parentNode.parentNode,hasClass($grdparent,"offcanvas-body")&&($needclone=!0),$needclone){if(hasClass(e,"is-checked"))return;$buttons=document.querySelectorAll('#clonedbuttons [data-filter-group="'+$parent+'"]');for(var l=0;l<$buttons.length;l++)$buttons[l].remove();"*"!=s&&(lib=t.srcElement.innerHTML,create_clone_button($parent,s,lib,"button",child),create_clone_listener(s))}"*"==s?(filters[$parent]=["*"],$isclone&&e.remove,child&&set_family_all(me,child,"button")):(filters[$parent]=[s],child&&set_family(me,"",child,s,"button")),update_cookie_filter(filters),iso.arrange(),updateFilterCounts()}}function filter_multi(e,t){var s=e.getAttribute("data-sort-value");if(child=e.getAttribute("data-child"),$isclone=!1,"clonedbuttons"==e.parentNode.id){$parent=e.getAttribute("data-filter-group"),$buttons=document.querySelectorAll(".iso_button_"+$parent+"_"+s);for(var l=0;l<$buttons.length;l++)toggleClass($buttons[l],"is-checked");$isclone=!0}else $parent=e.parentNode.getAttribute("data-filter-group"),toggleClass(e,"is-checked");var a=hasClass(e,"is-checked");if($needclone=!1,$grdparent=e.parentNode.parentNode,hasClass($grdparent,"offcanvas-body")&&($needclone=!0),$needclone&&(a?(lib=t.srcElement.innerHTML,create_clone_button($parent,s,lib,"multi",child),create_clone_listener(s)):(aclone=document.querySelector("#clonedbuttons .iso_button_"+$parent+"_"+s),aclone.remove())),void 0===filters[$parent]&&(filters[$parent]=[]),"*"==s){filters[$parent]=["*"],clones=document.querySelectorAll('#clonedbuttons [data-filter-group="'+$parent+'"]');for(l=0;l<clones.length;l++)clones[l].remove();child&&set_family_all(me,child,"button")}else removeFilter(filters,$parent,"*"),removeFilter(filters,$parent,"none"),a?(addFilter(filters,$parent,s),child&&set_family(me,$parent,child,s,"button")):(removeFilter(filters,$parent,s),0==filters[$parent].length&&(filters[$parent]=["*"],$isclone&&(aclone=document.querySelector(".filter-button-group-"+$parent+' [data-sort-value="*"]'),addClass(aclone,"is-checked"))),child&&(filters[$parent]==["*"]?set_family_all(me,child,"button"):del_family(me,$parent,child,s,"button")));update_cookie_filter(filters),iso.arrange(),updateFilterCounts()}function set_buttons_multi(e){if($parent=e.parentNode.getAttribute("data-filter-group"),"*"==e.getAttribute("data-sort-value")){buttons=e.parentNode.querySelectorAll("button.is-checked");for(var t=0;t<buttons.length;t++)removeClass(buttons[t],"is-checked");addClass(e,"is-checked")}else 0==filters[$parent].length||"*"==filters[$parent]?(button_all=e.parentNode.querySelector('[data-sort-value="*"]'),addClass(button_all,"is-checked"),filters[$parent]=["*"],update_cookie_filter(filters),iso.arrange()):(button_all=e.parentNode.querySelector('[data-sort-value="*"]'),removeClass(button_all,"is-checked"))}function updateFilterCounts(){for(var e=document.querySelectorAll(me+".isotope_item"),t=document.querySelector(me+".iso_button_more"),s=iso.getFilteredItemElements(),l=s.length,a=document.querySelector(me+".iso_div_empty"),i=0;i<e.length;i++)hasClass(e[i],"iso_hide_elem")&&removeClass(e[i],"iso_hide_elem");if(empty_message&&(0==l?removeClass(a,"iso_hide_elem"):hasClass(a,"iso_hide_elem")||addClass(a,"iso_hide_elem")),items_limit>0){for(var o=0;o<s.length;o++)o>=items_limit&&addClass(e[o],"iso_hide_elem");o<items_limit&&"infinite"!=options.pagination?addClass(t,"iso_hide_elem"):removeClass(t,"iso_hide_elem")}if(0==items_limit&&sav_limit>0&&"infinite"!=options.pagination){for(o=0;o<s.length;o++)hasClass(s[o],"iso_hide_elem")&&(l-=1);l>sav_limit?removeClass(t,"iso_hide_elem"):addClass(t,"iso_hide_elem")}iso.arrange()}function create_clone_button(e,t,s,l,a){buttons=document.querySelector("#clonedbuttons");var i=document.createElement("button");i.classList.add("btn"),i.classList.add("btn-sm"),i.classList.add("iso_button_"+e+"_"+t),i.classList.add("is-checked"),i.setAttribute("data-sort-value",t),i.setAttribute("data-filter-group",e),i.setAttribute("data-clone-type",l),a&&i.setAttribute("data-child",a),i.title=s,i.innerHTML=s,buttons.prepend(i)}function create_clone_listener(e){onebutton=document.querySelector('#clonedbuttons [data-sort-value="'+e+'"] '),onebutton.addEventListener("click",function(e){"multi"==this.getAttribute("data-clone-type")&&filter_multi(this),"button"==this.getAttribute("data-clone-type")&&filter_button(this),"list_multi"==this.getAttribute("data-clone-type")&&filter_list_multi(this,e,"remove"),"list"==this.getAttribute("data-clone-type")&&filter_list(this,e),this.remove()})}function debounce(e,t){var s;return function(){s&&clearTimeout(s),s=setTimeout(function(){e(),s=null},t||100)}}function addFilter(e,t,s){-1==e[t].indexOf(s)&&e[t].push(s)}function removeFilter(e,t,s){Array.isArray(e[t])||(e[t]=["*"]);var l=e[t].indexOf(s);-1!=l&&e[t].splice(l,1)}function update_cookie_filter(e){for(x in $filter_cookie="",e)$filter_cookie.length>0&&($filter_cookie+=">"),$filter_cookie+=x+"<"+e[x].toString();$filter_cookie.length>0&&($filter_cookie+=">"),CG_Cookie_Set(myid,"filter",$filter_cookie)}function getCookie(e){let t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):""}function CG_Cookie_Set(e,t,s){$secure="","https:"==window.location.protocol&&($secure="secure;"),lecookie=getCookie(cookie_name),$val=t+":"+s,$cook=$val,""!=lecookie&&(lecookie.indexOf(t)>=0?($cook="",$arr=lecookie.split("&"),$arr.forEach(replaceCookie,$val)):$cook=lecookie+"&"+$val),document.cookie=cookie_name+"="+$cook+"; path=/; samesite=lax;"+$secure}function replaceCookie(e,t,s){this.startsWith("search:")&&e.indexOf("search:")>=0&&(s[t]=this),this.startsWith("sort:")&&e.indexOf("sort:")>=0&&(s[t]=this),this.startsWith("filter:")&&e.indexOf("filter:")>=0&&(s[t]=this),this.startsWith("range:")&&e.indexOf("range:")>=0&&(s[t]=this),$cook.length>0&&($cook+="&"),$cook+=s[t]}function splitCookie(e){if(me="#isotope-main-"+myid+" ",quicksearch=document.querySelector(me+".quicksearch"),e.indexOf("search:")>=0&&"undefined"!=typeof quicksearch&&(val=e.split(":"),qsRegex=new RegExp(val[1],"gi"),quicksearch.value=val[1]),e.indexOf("sort:")>=0){for(val=e.split(":"),val=val[1].split("-"),sort_by=val[0].split(","),asc="true"==val[1],sortAsc={},i=0;i<sort_by.length;i++)"featured"==sort_by[i]?sortAsc[sort_by[i]]=!1:sortAsc[sort_by[i]]=asc;for(asc=sortAsc,sortButtons=document.querySelectorAll(me+".sort-by-button-group button"),s=0;s<sortButtons.length;s++)"*"!=val[0]&&(sortButtons[s].classList.remove("is-checked"),sortButtons[s].getAttribute("data-sort-value")==val[0]&&(sortButtons[s].classList.add("is-checked"),sortButtons[s].setAttribute("data-sens","+"),"true"!=val[1]&&sortButtons[s].setAttribute("data-sens","-")))}if(e.indexOf("filter:")>=0&&(val=e.split(":"),val[1].length>0))for(val=val[1].split(">"),x=0;x<val.length-1;x++)if(values=val[x].split("<"),-1!=std_parents.indexOf(values[0])){if("tags"==values[0]&&"listmulti"==options.displayfiltertags||"cat"==values[0]&&"listmulti"==options.displayfiltercat){var t=(a=document.querySelector("joomla-field-fancy-select#isotope-select-"+values[0])).choicesInstance;if(filters[values[0]]=values[1].split(","),"*"==values[1])t.setChoiceByValue("");else{for(t.removeActiveItemsByValue(""),vals=values[1].split(","),c=0;c<vals.length;c++)t.setChoiceByValue(vals[c]);if("offcanvas-body"==a.parentElement.parentElement.className)for(c=0;c<t.getValue().length;c++)lib=t.getValue()[c].label,sel=t.getValue()[c].value,child=null,create_clone_button(values[0],sel,lib,"list_multi",child),create_clone_listener(sel)}}else if("*"!=values[1]){for(filters[values[0]]=values[1].split(","),"lang"==values[0]?filterButtons=document.querySelectorAll(me+".iso_lang button.is-checked"):filterButtons=document.querySelectorAll(me+".filter-button-group-"+values[0]+" button.is-checked"),f=0;f<filterButtons.length;f++)filterButtons[f].classList.remove("is-checked");for(v=0;v<filters[values[0]].length;v++){if("tags"==values[0]&&"list"==options.displayfiltertags||"cat"==values[0]&&"list"==options.displayfiltercat){if((t=(a=document.querySelector("joomla-field-fancy-select#isotope-select-"+values[0])).choicesInstance).setChoiceByValue(filters[values[0]][v]),"offcanvas-body"==a.parentElement.parentElement.className){t=a.choicesInstance;sel=filters[values[0]][v],lib=t.getValue().label,child=null,create_clone_button(values[0],sel,lib,"list",child),create_clone_listener(sel)}}else $button=document.querySelector(me+".iso_button_"+values[0]+"_"+filters[values[0]][v]),addClass($button,"is-checked"),hasClass($button.parentNode.parentNode,"offcanvas-body")&&($type="button",("cat"!=values[0]||"multi"!=options.displayfiltercat&&"multiex"!=options.displayfiltercat)&&("tags"!=values[0]||"multi"!=options.displayfiltertags&&"multiex"!=options.displayfiltercat)&&("alpha"!=values[0]||"multi"!=options.displayalpha&&"multiex"!=options.displayalpha)||($type="multi"),child=null,lib=$button.innerHTML,create_clone_button(values[0],filters[values[0]][v],lib,$type,child),create_clone_listener(filters[values[0]][v]))}}}else if("listmulti"==options.displayfilterfields){var a;t=(a=document.querySelector("joomla-field-fancy-select#isotope-select-"+values[0])).choicesInstance;if(filters[values[0]]=values[1].split(","),"*"==values[1])t.setChoiceByValue("");else{for(t.removeActiveItemsByValue(""),vals=values[1].split(","),c=0;c<vals.length;c++)t.setChoiceByValue(vals[c]);if("offcanvas-body"==a.parentElement.parentElement.className)for(c=0;c<t.getValue().length;c++)lib=t.getValue()[c].label,sel=t.getValue()[c].value,child=null,create_clone_button(values[0],sel,lib,"list",child),create_clone_listener(sel)}}else if("*"!=values[1]){for(alist=document.querySelectorAll(me+".class_fields_"+values[0]+" .is-checked"),l=0;l<alist.length;l++)alist[l].classList.remove("is-checked");for(filters[values[0]]=values[1].split(","),v=0;v<filters[values[0]].length;v++)"list"==options.displayfilterfields||"listex"==options.displayfilterfields?(t=(a=document.querySelector("joomla-field-fancy-select#isotope-select-"+values[0])).choicesInstance,filters[values[0]]=values[1].split(","),"*"==values[1]?t.setChoiceByValue(""):(t.removeActiveItemsByValue(""),t.setChoiceByValue(values[1]),"offcanvas-body"==a.parentElement.parentElement.parentElement.className&&(lib=t.getValue().label,sel=t.getValue().value,child=null,create_clone_button(values[0],sel,lib,"list",child),create_clone_listener(sel)))):($this=document.querySelector(me+".iso_button_"+values[0]+"_"+filters[values[0]][v]),addClass($this,"is-checked"),child=$this.getAttribute("data-child"),child&&(sortValue=$this.getAttribute("data-sort-value"),set_family(me,"",child,sortValue,"button")),hasClass($this.parentNode.parentNode.parentNode,"offcanvas-body")&&($type="button",lib=$this.innerHTML,create_clone_button(values[0],filters[values[0]][v],lib,$type,child),create_clone_listener(filters[values[0]][v])))}e.indexOf("range:")>=0&&(val=e.split(":"),val[1].length>0&&(spl=val[1].split(","),min_range=parseInt(spl[0]),max_range=parseInt(spl[1])))}function set_family(e,t,s,l,a){for(parents=[];s;){if("list"==a){$this=document.querySelector(e+'.filter-button-group-fields [data-group-id="'+s+'"]'),listoptions=$this.querySelectorAll("option");for(var i=0;i<listoptions.length;i++)hasClass(listoptions[i],"iso_hide_elem")||addClass(listoptions[i],"iso_hide_elem");$all=$this.querySelector('[data-all="all"]'),removeClass($all,"iso_hide_elem"),$all.setAttribute("selected",!0),s=$all.getAttribute("data-child")}else{if($myparent=document.querySelector(e+".filter-button-group-fields").parentNode,$this=$myparent.querySelector('[data-group-id="'+s+'"]'),""==t||""!=t&&1==filters[t].length&&"*"!=filters[t]){buttons=$this.querySelectorAll("button");for(i=0;i<buttons.length;i++)hasClass(buttons[i],"iso_hide_elem")||addClass(buttons[i],"iso_hide_elem"),removeClass(buttons[i],"is-checked")}abutton=$this.querySelector("button.iso_button_tout"),removeClass(abutton,"iso_hide_elem"),addClass(abutton,"is-checked"),s=abutton.getAttribute("data-child")}if(0==parents.length){buttons=$this.querySelectorAll('[data-parent="'+l+'"]');for(i=0;i<buttons.length;i++)removeClass(buttons[i],"iso_hide_elem");if(newparents=$this.querySelectorAll('[data-parent="'+l+'"]'),parents=[],newparents.length>0)for($i=0;$i<newparents.length;$i++)$val="list"==a?newparents[$i].getAttribute("value"):newparents[$i].getAttribute("data-sort-value"),"*"!=$val&&parents.push($val)}else{for(newparents=[],$i=0;$i<parents.length;$i++)if("*"!=(l=parents[$i])){buttons=$this.querySelectorAll('[data-parent="'+l+'"]');for(i=0;i<buttons.length;i++)removeClass(buttons[i],"iso_hide_elem");if($vals=$this.querySelectorAll('[data-parent="'+l+'"]'),$vals.length>0)for($j=0;$j<$vals.length;$j++)$val="list"==a?$vals[$j].getAttribute("value"):$vals[$j].getAttribute("data-sort-value"),"*"!=$val&&newparents.push($val)}parents=newparents}childstr=$this.getAttribute("data-filter-group"),filters[childstr]=["*"],l=""}}function del_family(e,t,s,l,a){for(parents=[];s;){if(myparent=document.querySelector(e+".filter-button-group-fields").parentNode,$this=myparent.querySelector('[data-group-id="'+s+'"]'),abutton=$this.querySelector('[data-parent="'+l+'"]'),addClass(abutton,"iso_hide_elem"),removeClass(abutton,"is-checked"),abutton=$this.querySelector("button.iso_button_tout"),removeClass(abutton,"iso_hide_elem"),addClass(abutton,"is-checked"),s=$this.getAttribute("data-child"),0==parents.length){if(newparents=$this.querySelectorAll('[data-parent="'+l+'"]'),parents=[],newparents.length>0)for($i=0;$i<newparents.length;$i++)$val="list"==a?newparents[$i].getAttribute("value"):newparents[$i].getAttribute("data-sort-value"),"*"!=$val&&(parents.push($val),addClass(newparents[$i],"iso_hide_elem"))}else{for(newparents=[],$i=0;$i<parents.length;$i++)if("*"!=(l=parents[$i])&&($vals=$this.querySelectorAll('[data-parent="'+l+'"]'),$vals.length>0))for($j=0;$j<$vals.length;$j++)$val="list"==a?$vals[$j].getAttribute("value"):$vals[$j].getAttribute("data-sort-value"),"*"!=$val&&(newparents.push($val),addClass($vals[$j],"iso_hide_elem"));parents=newparents}childstr=$this.getAttribute("data-filter-group"),filters[childstr]=["*"],l=""}}function set_family_all(e,t,s){for(parents=[];t;){for($this="list"==s?document.querySelector(e+".filter-button-group-fields"):document.querySelector(e+".filter-button-group-fields").parentNode,parents=$this.querySelectorAll('[data-child="'+t+'"]'),l=0;l<parents.length;l++)hasClass(parents[l],"iso_hide_elem")||($val="list"==s?parents[l].getAttribute("value"):parents[l].getAttribute("data-sort-value"),$val&&"*"!=$val&&removeClass($this.querySelector('[data-parent="'+$val+'"]'),"iso_hide_elem"));if("list"==s)allbuton=$this.querySelector('[data-group-id="'+t+'"] [data-all="all"]'),t=allbutton.getAttribute("data-child");else{buttons=$this.querySelectorAll('[data-group-id="'+t+'"] button');for(var l=0;l<buttons.length;l++)removeClass(buttons[l],"is-checked");addClass($this.querySelector('[data-group-id="'+t+'"] button.iso_button_tout'),"is-checked"),myparent=$mychild=$this.querySelector('[data-group-id="'+t+'"]'),$mychild_all=$mychild.querySelector("button.iso_button_tout"),t=$mychild_all.getAttribute("data-child")}childstr=$this.getAttribute("data-filter-group"),filters[childstr]=["*"]}}function go_click(e,t){event.preventDefault(),"webLinks"==e||window.event.ctrlKey?window.open(t,"_blank"):location=t}document.addEventListener("DOMContentLoaded",function(){mains=document.querySelectorAll(".isotope-main");for(var e=0;e<mains.length;e++){var t=mains[e];if(myid=t.getAttribute("data"),"undefined"==typeof Joomla||void 0===Joomla.getOptions)return console.error("Joomla.getOptions not found!\nThe Joomla core.js file is not being loaded."),!1;if(void 0===(options=Joomla.getOptions("cg_isotope_"+myid)))return!1;cookie_name="cg_isotope_"+myid,iso_cat_k2(myid,options)}if(grid_toggle=document.querySelector(".isotope_grid"),iso_article=document.querySelector(".isotope_an_article"),iso_div=document.querySelector(".isotope-main .isotope-div"),article_frame=document.querySelector("iframe#isotope_article_frame"),"ajax"==options.readmore||"iframe"==options.readmore){iso_height=grid_toggle.offsetHeight,iso_width=grid_toggle.offsetWidth,readmoretitles=document.querySelectorAll(".isotope-readmore-title");for(var s=0;s<readmoretitles.length;s++)["click","touchstart"].forEach(e=>{readmoretitles[s].addEventListener(e,function(e){if($pos=iso_div.offsetTop,document.querySelector("body").scrollTo($pos,1e3),e.stopPropagation(),e.preventDefault(),addClass(grid_toggle,"isotope-hide"),addClass(iso_article,"isotope-open"),removeClass(iso_article,"isotope-hide"),iso_article.offsetHeight="auto",addClass(iso_article,"article-loading"),"ajax"==options.readmore){document.querySelector("#isotope_an_article").innerHTML="";var t=document.getElementById("token");token=t.getAttribute("name"),$.ajax({data:{[token]:"1",task:"display",format:"json",article:this.dataset.articleid,entree:options.entree},success:function(e,t,s){removeClass(iso_article,"article-loading"),iso_article.style.height=iso_height,iso_article.style.width=iso_width+"px",e.success||(e.success=!0),displayArticle(e)},error:function(e){console.log(e.responseText)}})}else"iframe"==options.readmore&&(0==iso_height&&(iso_height="100vh"),article_frame.style.height=0,article_frame.style.width=0,achar="?",this.dataset.href.indexOf("?")>0&&(achar="&"),article_frame.setAttribute("src",this.dataset.href+achar+"tmpl=component"),addClass(iso_article,"article-loading"),$close=document.querySelector("button.close"),addClass($close,"isotope-hide"),["click","touchstart"].forEach(e=>{$close.addEventListener(e,function(){resetToggle()})}));["click","touchstart"].forEach(e=>{grid_toggle.addEventListener(e,function(){resetToggle()})})})})}["click","touchstart"].forEach(e=>{iso_div.addEventListener(e,function(){resetToggle()})}),resetToggle=function(){grid_toggle&&hasClass(grid_toggle,"isotope-hide")?(removeClass(iso_article,"isotope-open"),addClass(iso_article,"isotope-hide"),removeClass(grid_toggle,"isotope-hide"),iso_div.refresh):iso_article&&hasClass(iso_article,"isotope-open")&&(removeClass(iso_article,"isotope-open"),addClass(iso_article,"isotope-hide"),iso_article.innerHTML(""),iso_div.refresh)},article_frame&&article_frame.addEventListener("load",function(){removeClass(iso_article,"article-loading"),$close&&removeClass($close,"isotope-hide"),article_frame.style.height=iso_height,article_frame.style.width=iso_width+"px"})}),hasClass=function(e,t){var s=new RegExp("(?:\\s|^)"+t+"(?:\\s|$)");return!!e.className.match(s)},addClass=function(e,t){e.className+=" "+t},removeClass=function(e,t){var s=new RegExp("(?:\\s|^)"+t+"(?:\\s|$)");e.className=e.className.replace(s," ")},toggleClass=function(e,t){hasClass(e,t)?removeClass(e,t):addClass(e,t)};var scrollTo=function(e,t){var s=document.scrollingElement||document.documentElement,l=s.scrollTop,a=e-l,i=performance.now(),o=function(r){var n,c,u,d=r-i;s.scrollTop=parseInt((n=d,c=l,u=a,(n/=t/2)<1?u/2*n*n+c:-u/2*(--n*(n-2)-1)+c)),d<t?requestAnimationFrame(o):s.scrollTop=e};requestAnimationFrame(o)};